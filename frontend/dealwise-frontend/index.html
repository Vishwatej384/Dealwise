<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>DealWise ‚Äî Smart Shopping</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Styles (make sure this path matches your project) -->
  <link rel="stylesheet" href="css/style.css">

  <!-- App JS (deferred) -->
  <script defer src="js/main.js"></script>
</head>
<body>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="nav-left">
      <!-- stylish bag SVG icon + brand -->
      <div class="brand">
        <svg class="bag-icon" viewBox="0 0 24 24" width="36" height="36" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
          <path fill="#00e5ff" d="M6 7V6a6 6 0 0 1 12 0v1h1a1 1 0 0 1 1 1v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a1 1 0 0 1 1-1h1zm2 0h8V6a4 4 0 0 0-8 0v1z"/>
          <path fill="#001" fill-opacity="0.06" d="M4 8h16v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z"/>
        </svg>
        <div class="brand-text">
          <div class="brand-name">DealWise</div>
          <div class="brand-tag">Smart Deals ‚Ä¢ Verified</div>
        </div>
      </div>
    </div>

    <nav class="nav-center">
      <a href="#home" class="nav-link active">Home</a>
      <a href="#categories" class="nav-link">Categories</a>
      <a href="#top-deals" class="nav-link">Top Deals</a>
      <a href="#about" class="nav-link">About</a>
      <a href="#contact" class="nav-link">Contact</a>
    </nav>

    <div class="nav-right">
      <div class="search-wrap">
        <input id="searchInput" placeholder="Search deals, gadgets, categories..." />
      </div>

      <button class="icon-btn cart-btn" title="Cart (demo)">
        üõí <span class="cart-count">0</span>
      </button>

      <button id="loginBtn" class="btn-ghost">Login</button>
      <button id="signupBtn" class="btn-accent">Sign Up</button>
    </div>
  </header>

  <!-- HERO -->
  <main id="home">
    <section class="hero reveal">
      <div class="hero-inner">
        <div class="hero-left">
          <h1 class="hero-title">Discover Best Deals.<br><span>Save Smarter.</span></h1>
          <p class="hero-sub">DealWise consolidates verified deals, honest reviews and price tracking so you always buy with confidence.</p>
          <div class="hero-ctas">
            <button onclick="scrollToId('top-deals')" class="btn-accent">Browse Deals</button>
            <button onclick="scrollToId('categories')" class="btn-ghost">Shop by Category</button>
          </div>
        </div>

        <div class="hero-right">
          <div class="hero-card">
            <img src="https://images.unsplash.com/photo-1585386959984-a4155223f8a2?auto=format&fit=crop&w=800&q=80" alt="Top Deal - Headphones">
            <div class="hero-card-info">
              <strong>Wireless Headphones</strong>
              <span class="muted">Now ‚Çπ2,499 ‚Ä¢ 30% off</span>
            </div>
          </div>
          <div class="hero-badge">Trusted deals ‚Ä¢ real users</div>
        </div>
      </div>
    </section>

    <!-- WHY CHOOSE -->
    <section class="why container reveal">
      <h2 class="section-title">Why Choose DealWise</h2>
      <div class="why-grid">
        <div class="why-card">
          <div class="why-icon">üîç</div>
          <h3>Smart Discovery</h3>
          <p>Find curated, highest-value offers across multiple platforms.</p>
        </div>
        <div class="why-card">
          <div class="why-icon">üõ°Ô∏è</div>
          <h3>Verified Trust</h3>
          <p>We verify sellers and surface honest user reviews.</p>
        </div>
        <div class="why-card">
          <div class="why-icon">üí∏</div>
          <h3>Price Alerts</h3>
          <p>Track price history and get notified when prices drop.</p>
        </div>
      </div>
    </section>

    <!-- CATEGORIES -->
    <section id="categories" class="container categories reveal">
      <h2 class="section-title">Shop by Category</h2>
      <div class="cat-grid">
        <button class="cat-card" onclick="showCategory('electronics')">
          <img src="https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?auto=format&fit=crop&w=600&q=80" alt="Electronics">
          <div>Electronics</div>
        </button>
        <button class="cat-card" onclick="showCategory('fashion')">
          <img src="https://images.unsplash.com/photo-1489987707025-afc232f7ea0f?auto=format&fit=crop&w=600&q=80" alt="Fashion">
          <div>Fashion</div>
        </button>
        <button class="cat-card" onclick="showCategory('home')">
          <img src="https://images.unsplash.com/photo-1505691723518-36a0f3c6e1e4?auto=format&fit=crop&w=600&q=80" alt="Home">
          <div>Home & Kitchen</div>
        </button>
        <button class="cat-card" onclick="showCategory('fitness')">
          <img src="https://images.unsplash.com/photo-1517960413843-0aee8e2b76f6?auto=format&fit=crop&w=600&q=80" alt="Fitness">
          <div>Fitness</div>
        </button>
        <button class="cat-card" onclick="showCategory('gaming')">
          <img src="https://images.unsplash.com/photo-1587206662676-2c03f2b2b6b8?auto=format&fit=crop&w=600&q=80" alt="Gaming">
          <div>Gaming</div>
        </button>
        <button class="cat-card" onclick="showCategory('beauty')">
          <img src="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=600&q=80" alt="Beauty">
          <div>Beauty</div>
        </button>
      </div>
    </section>

    <!-- TOP DEALS -->
    <section id="top-deals" class="container deals reveal">
      <h2 class="section-title">üî• Top Deals</h2>
      <div class="deals-grid" id="dealsGrid">
        <!-- cards inserted by JS (initial set below as fallback) -->
      </div>
    </section>

    <!-- CATEGORY ITEMS (dynamic) -->
    <section id="category-items" class="container reveal" style="display:none;">
      <h2 class="section-title" id="category-items-title">Category</h2>
      <div id="categoryItemsGrid" class="deals-grid"></div>
      <div style="text-align:center; margin-top:18px;">
        <button class="btn-ghost" onclick="hideCategoryItems()">Back to Categories</button>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" class="container about reveal">
      <h2 class="section-title">About DealWise</h2>
      <div class="about-grid">
        <div>
          <p><strong>DealWise</strong> curates verified offers and user feedback so you can shop confidently ‚Äî saving time and money.</p>
          <ul class="about-list">
            <li>üîé Multi-source deal consolidation</li>
            <li>üßæ Honest reviews & ratings</li>
            <li>üîî Price history & alerts</li>
            <li>üîí Secure demo checkout (backend coming)</li>
          </ul>
        </div>
        <div class="about-image">
          <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?auto=format&fit=crop&w=800&q=80" alt="About DealWise">
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <section id="contact" class="container contact reveal">
      <h2 class="section-title">Get in touch</h2>
      <p class="muted">Questions, feedback or collaboration ideas? Drop a message.</p>
      <form id="contactForm" class="contact-form">
        <input name="name" placeholder="Your name" required />
        <input name="email" placeholder="Your email" required />
        <textarea name="message" rows="4" placeholder="Message" required></textarea>
        <div class="form-actions">
          <button type="submit" class="btn-accent">Send Message</button>
        </div>
      </form>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-left">
        <div class="brand-footer">
          <svg class="bag-icon" viewBox="0 0 24 24" width="30" height="30" xmlns="http://www.w3.org/2000/svg">
            <path fill="#00e5ff" d="M6 7V6a6 6 0 0 1 12 0v1h1a1 1 0 0 1 1 1v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V8a1 1 0 0 1 1-1h1zm2 0h8V6a4 4 0 0 0-8 0v1z"/>
          </svg>
          <div>
            <div class="brand-name">DealWise</div>
            <div class="muted">¬© 2025 DealWise</div>
          </div>
        </div>
      </div>

      <div class="footer-center">
        <nav class="footer-links">
          <a href="#top-deals">Top Deals</a>
          <a href="#categories">Categories</a>
          <a href="#about">About</a>
          <a href="#contact">Contact</a>
        </nav>
      </div>

      <div class="footer-right">
        <div class="socials">
          <a href="#" title="Instagram">üì∏</a>
          <a href="#" title="Twitter/X">üê¶</a>
          <a href="#" title="LinkedIn">üíº</a>
          <a href="#" title="YouTube">‚ñ∂Ô∏è</a>
        </div>
        <div class="footer-licenses">
          <a href="#">Privacy</a> ‚Ä¢ <a href="#">Terms</a> ‚Ä¢ <a href="#">Licenses</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- LOGIN MODAL -->
  <div id="loginModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <button class="modal-close" aria-label="Close">√ó</button>
      <h3>Welcome back</h3>
      <p class="muted">Sign in to access your saved deals and cart.</p>
      <input id="loginEmail" placeholder="Email" />
      <input id="loginPassword" type="password" placeholder="Password" />
      <div style="margin-top:12px;">
        <button id="doLogin" class="btn-accent">Login</button>
      </div>
      <p class="muted small">Don't have an account? <a href="#" id="openSignup">Create one</a></p>
    </div>
  </div>

  <!-- SIGNUP MODAL -->
  <div id="signupModal" class="modal" aria-hidden="true">
    <div class="modal-card">
      <button class="modal-close" aria-label="Close">√ó</button>
      <h3>Create Account</h3>
      <p class="muted">Join DealWise to save deals and get alerts.</p>
      <input id="signupName" placeholder="Full name" />
      <input id="signupEmail" placeholder="Email" />
      <input id="signupPassword" type="password" placeholder="Password" />
      <div style="margin-top:12px;"><button id="doSignup" class="btn-accent">Sign Up</button></div>
    </div>
  </div>

  <!-- keep your existing JS (main.js) loading earlier; below is only the small backend-connection helper -->
  <script>
    // ---------- CONFIG ----------
    const API_BASE = "http://localhost:8080/api"; // backend base URL

    // Utility: set up modal open/close (if your main.js doesn't handle it)
    (function attachModalHandlers() {
      // open/close behaviour (non-intrusive ‚Äî will not change styles)
      const loginBtn = document.getElementById('loginBtn');
      const signupBtn = document.getElementById('signupBtn');
      const loginModal = document.getElementById('loginModal');
      const signupModal = document.getElementById('signupModal');
      const openSignupLink = document.getElementById('openSignup');

      function open(modal) {
        if (!modal) return;
        modal.style.display = "block";
        modal.setAttribute('aria-hidden', 'false');
      }
      function close(modal) {
        if (!modal) return;
        modal.style.display = "none";
        modal.setAttribute('aria-hidden', 'true');
      }

      // show modals
      if (loginBtn) loginBtn.addEventListener('click', () => open(loginModal));
      if (signupBtn) signupBtn.addEventListener('click', () => open(signupModal));
      if (openSignupLink) openSignupLink.addEventListener('click', (e) => {
        e.preventDefault();
        close(loginModal);
        open(signupModal);
      });

      // close buttons (if any)
      document.querySelectorAll('.modal-close').forEach(btn => {
        btn.addEventListener('click', () => {
          const modal = btn.closest('.modal');
          close(modal);
        });
      });

      // click outside to close
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) close(modal);
        });
      });
    })();

    // ---------- AUTH: LOGIN ----------
    document.getElementById("doLogin")?.addEventListener("click", async () => {
      const emailEl = document.getElementById("loginEmail");
      const passEl = document.getElementById("loginPassword");
      const email = emailEl?.value?.trim();
      const password = passEl?.value?.trim();

      if (!email || !password) {
        alert("Please enter both email and password.");
        return;
      }

      try {
        const res = await fetch(`${API_BASE}/auth/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, password })
        });

        if (!res.ok) {
          const err = await res.json().catch(()=>null);
          throw new Error(err?.error || "Login failed");
        }

        const data = await res.json();
        // store token & name in localStorage (frontend will use to show profile)
        if (data.token) {
          localStorage.setItem("dealwise_token", data.token);
          if (data.name) localStorage.setItem("dealwise_name", data.name);
          alert("Login successful!");
          // hide login modal
          const loginModal = document.getElementById('loginModal');
          if (loginModal) { loginModal.style.display = "none"; loginModal.setAttribute('aria-hidden','true'); }
          // optional: call a function to update UI to show profile (not included to avoid changing design)
        } else {
          alert("Login succeeded but token missing in response.");
        }
      } catch (err) {
        alert("Login error: " + err.message);
      }
    });

    // ---------- AUTH: SIGNUP ----------
    document.getElementById("doSignup")?.addEventListener("click", async () => {
      const name = document.getElementById("signupName")?.value?.trim();
      const email = document.getElementById("signupEmail")?.value?.trim();
      const password = document.getElementById("signupPassword")?.value?.trim();

      if (!name || !email || !password) {
        alert("Please fill all the signup fields.");
        return;
      }

      try {
        const res = await fetch(`${API_BASE}/auth/signup`, { // server endpoint name: /auth/signup expected
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ name, email, password })
        });

        if (!res.ok) {
          const err = await res.json().catch(()=>null);
          throw new Error(err?.error || "Signup failed");
        }

        const data = await res.json();
        if (data.success || res.status === 201 || res.ok) {
          alert("Signup successful! Please login.");
          // hide signup modal and open login
          const signupModal = document.getElementById('signupModal');
          const loginModal = document.getElementById('loginModal');
          if (signupModal) { signupModal.style.display = "none"; signupModal.setAttribute('aria-hidden','true'); }
          if (loginModal) { loginModal.style.display = "block"; loginModal.setAttribute('aria-hidden','false'); }
        } else {
          alert("Signup response: " + JSON.stringify(data));
        }
      } catch (err) {
        alert("Signup error: " + err.message);
      }
    });

    // ---------- OPTIONAL: Contact form submission (non-destructive) ----------
    document.getElementById("contactForm")?.addEventListener("submit", async (e) => {
      e.preventDefault();
      // keep behaviour local ‚Äî send to backend only if you implement contact endpoint
      const form = e.target;
      const formData = Object.fromEntries(new FormData(form).entries());
      // If you have an API endpoint to accept contact messages, post it here:
      // await fetch(`${API_BASE}/contact`, { method: "POST", headers:{'Content-Type':'application/json'}, body: JSON.stringify(formData) })
      alert("Thanks ‚Äî message captured locally (not sent).");
      form.reset();
    });

    // ---------- HEALTH CHECK (console) ----------
    (function backendHealthCheck(){
      fetch("http://localhost:8080/hello")
        .then(r => r.text())
        .then(t => console.log("Backend says:", t))
        .catch(() => console.warn("Backend not reachable at http://localhost:8080/hello"));
    })();

    // ---------- HELPER: scroll helper used in markup (keeps existing behavior) ----------
    function scrollToId(id) {
      const el = document.getElementById(id);
      if (!el) return;
      el.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // ---------- HELPER: category handlers placeholder (keeps existing behavior) ----------
    function showCategory(cat) {
      // If you implement /api/deals?category=... you can fetch matching items and render into #categoryItemsGrid
      // For now the UI will show the category section and placeholder.
      document.getElementById('category-items-title').textContent = cat[0].toUpperCase() + cat.slice(1);
      document.getElementById('categoryItemsGrid').innerHTML = '<div class="muted" style="padding:20px;">Loading items for ' + cat + '...</div>';
      document.getElementById('category-items').style.display = 'block';
      window.scrollTo({ top: document.getElementById('category-items').offsetTop - 80, behavior: 'smooth' });

      // Example fetch for real data (backend must implement endpoint):
      // fetch(`${API_BASE}/deals?category=${encodeURIComponent(cat)}`).then(r=>r.json()).then(renderDeals);
    }
    function hideCategoryItems() {
      document.getElementById('category-items').style.display = 'none';
    }

    // ---------- placeholder for rendering deals (keeps UI untouched) ----------
    function renderDeals(deals, containerId = 'dealsGrid') {
      const cont = document.getElementById(containerId);
      if (!cont) return;
      cont.innerHTML = deals.map(d => `
        <div class="deal-card">
          <img src="${d.imageUrl || ''}" alt="${d.title || ''}" />
          <h3>${d.title || ''}</h3>
          <p>${d.price || ''} ${d.discount ? ' ‚Ä¢ ' + d.discount : ''}</p>
          <button class="btn small">Add to Cart</button>
        </div>
      `).join('');
    }

  </script>
</body>
</html>
